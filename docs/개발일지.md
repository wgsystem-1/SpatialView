# SpatialView 개발일지

> 이 문서는 SpatialView 프로젝트의 개발 진행 상황, 기능 구현, 버그 수정 등을 시간순으로 기록합니다.

---

## 2026-01-10

### 14:30 - 스타일링 시스템 구현 완료

#### 구현 내용
- **`LayerRenderStyle` 클래스 추가** (`RenderContext.cs`)
  - 채움 색상 (FillColor)
  - 외곽선 색상 (StrokeColor)
  - 외곽선 두께 (StrokeWidth)
  - 투명도 (Opacity)
  - 포인트 크기 (PointSize)
  - 포인트 심볼 타입 (Circle, Square, Triangle, Diamond, Cross, Star)
  - 라인 대시 패턴 (DashPattern)

- **`VectorRenderer` 스타일 적용 메서드 추가**
  - `RenderGeometryWithLayerStyle()` - 레이어 스타일 기반 렌더링
  - `RenderPointWithStyle()` - 다양한 심볼 타입 지원
  - `RenderLineStringWithStyle()` - 대시 패턴 지원
  - `RenderPolygonWithStyle()` - 채움/외곽선 옵션

- **`WpfMapRenderer.CreateLayerStyle()` 추가**
  - VectorLayer.Style에서 LayerRenderStyle 생성
  - 투명도 계산 (레이어 투명도 × 스타일 투명도)

---

### 15:00 - 투명도 기능 버그 수정

#### 문제
- 레이어 패널에서 투명도 슬라이더 조절 시 실제 렌더링에 반영되지 않음

#### 원인
- `SpatialViewVectorLayerAdapter.Opacity` 설정 시 `SyncStyleToEngine()` 미호출
- Engine의 `VectorLayer.Style`에 투명도가 동기화되지 않음

#### 수정
- `SpatialViewVectorLayerAdapter.cs`:
  ```csharp
  public double Opacity
  {
      set
      {
          _engineLayer.Opacity = value;
          if (_style != null)
          {
              _style.Opacity = (float)value;
          }
          SyncStyleToEngine();  // 추가
      }
  }
  ```

---

### 15:30 - 프로젝트 파일 로드 버그 수정 (1차)

#### 문제
- 프로젝트 파일(.svproj) 로드 시 "파일을 찾을 수 없음" 오류

#### 원인
- FileGDB(.gdb)는 **디렉토리**인데 `File.Exists()`로 확인
- 디렉토리는 `File.Exists()`가 `false` 반환

#### 수정
- `MainViewModel.LoadProjectAsync()`:
  ```csharp
  var isGdb = absolutePath.EndsWith(".gdb", StringComparison.OrdinalIgnoreCase);
  var pathExists = isGdb ? Directory.Exists(absolutePath) : File.Exists(absolutePath);
  ```

---

### 16:00 - 프로젝트 파일 로드 버그 수정 (2차)

#### 문제
- FileGDB에서 3개 레이어 중 1개만 로드됨

#### 원인
- `DataLoaderService.LoadFileAsync()`가 FileGDB의 **첫 번째 레이어만** 로드
- 프로젝트에 저장된 특정 레이어를 이름으로 로드하는 기능 없음

#### 수정
1. **`FileGdbDataProvider`에 새 메서드 추가**:
   - `LoadLayerByNameAsync(string gdbPath, string layerName)` - 이름으로 단일 레이어 로드
   - `LoadLayersByNamesAsync(string gdbPath, IEnumerable<string> layerNames)` - 이름 목록으로 다중 레이어 로드

2. **`MainViewModel.LoadProjectAsync()` 로직 개선**:
   - FileGDB 레이어를 GDB 경로별로 그룹화
   - `LoadLayersByNamesAsync()`로 필요한 레이어만 로드
   - 일반 파일(Shapefile, GeoJSON)은 기존 방식 유지

---

### 17:00 - GitHub 저장소 초기화 및 푸시

#### 작업 내용
- Git 저장소 초기화 (`git init`)
- `.gitignore` 파일 생성 (빌드 결과물, VS 파일 등 제외)
- 원격 저장소 연결: https://github.com/wgsystem-1/SpatialView
- 초기 커밋 및 푸시 완료

---

### 17:30 - README.md 작성

#### 내용
- 프로젝트 소개 및 주요 기능
- 아키텍처 및 기술 스택
- 빌드 및 실행 방법
- 사용법 가이드
- 지원 좌표계
- 기여 방법

---

## 향후 계획

### 🔧 버그 수정 예정
- [ ] 대용량 데이터 로드 시 UI 프리징 개선
- [ ] 특정 좌표계 변환 오류 확인

### ✨ 기능 추가 예정
- [ ] 라벨링 기능 (피처 속성 텍스트 표시)
- [ ] 측정 도구 (거리, 면적)
- [ ] 좌표계 변환 기능
- [ ] 내보내기 기능 (이미지, PDF)
- [ ] 속성 테이블 필터링/검색
- [ ] 배경지도 지원 (OSM, Bing Maps 등)
- [ ] 편집 기능 (피처 생성/수정/삭제)

### 🔨 리팩토링 예정
- [ ] 렌더링 성능 최적화 (타일 캐싱)
- [ ] 메모리 사용량 최적화
- [ ] 단위 테스트 추가

---

## 변경 이력 요약

| 날짜 | 시간 | 내용 |
|------|------|------|
| 2026-01-10 | 17:30 | README.md 작성 |
| 2026-01-10 | 17:00 | GitHub 저장소 초기화 및 푸시 |
| 2026-01-10 | 16:00 | 프로젝트 파일 로드 버그 수정 (FileGDB 다중 레이어) |
| 2026-01-10 | 15:30 | 프로젝트 파일 로드 버그 수정 (FileGDB 디렉토리 인식) |
| 2026-01-10 | 15:00 | 투명도 기능 버그 수정 |
| 2026-01-10 | 14:30 | 스타일링 시스템 구현 완료 |
